version: 2

models:
  - name: dim_epc_addresses
    description: Addresses in Energy Performance Certificate dataset for matching.
    columns:
      - name: epc_id
        tests:
          - not_null
          - unique
      - name: postcode
        tests:
          - not_null
    tests:
      - dbt_expectations.expect_compound_columns_to_be_unique:
          column_list: [
            "building_reference_number",
            "address_line_1",
            "address_line_2",
            "address_line_3",
            "post_town",
            "postcode"
          ]
  - name: dim_ppd_addresses
    description: Addresses in Price Paid dataset for matching.
    columns:
      - name: ppd_id
        tests:
          - not_null
          - unique
      - name: postcode
        tests:
          - not_null
    tests:
      - dbt_expectations.expect_compound_columns_to_be_unique:
          column_list: [
            "primary_addressable_object_name",
            "secondary_addressable_object_name",
            "street",
            "town_city",
            "postcode",
          ]
